@inject IPocRepo _pocs
@inject NavigationManager _nav

<div class="row">
    <div class="col col-sm-12 col-md-6">
        <EditForm Model="@PocListVm" OnValidSubmit="@CreatePoc">
            <DataAnnotationsValidator />
            <Microsoft.AspNetCore.Components.Forms.ValidationSummary></Microsoft.AspNetCore.Components.Forms.ValidationSummary>

            <FormFieldComponent LabelName="First">
                <ControlToRender>
                    <InputText class="form-control" @bind-Value="PocListVm.FirstName" />
                </ControlToRender>
            </FormFieldComponent>

            <FormFieldComponent LabelName="Last">
                <ControlToRender>
                    <InputText class="form-control" @bind-Value="PocListVm.LastName" />
                </ControlToRender>
            </FormFieldComponent>

            <FormFieldComponent LabelName="Initials">
                <ControlToRender>
                    <InputText class="form-control" @bind-Value="PocListVm.Name" />
                </ControlToRender>
            </FormFieldComponent>

            <FormFieldComponent LabelName="IsActive?">
                <ControlToRender>
                    <InputCheckbox @bind-Value="PocListVm.IsActive" />
                </ControlToRender>
            </FormFieldComponent>

            <button type="submit" class="btn btn-primary btn-sm">ENTER</button>

            <a href="/pocs" class="btn btn-sm btn-danger">Cancel</a>

        </EditForm>
    </div>
</div>

@code {
    public PocListVm PocListVm { get; set; } = new();

    protected async Task CreatePoc()
    {
        var poc = Mapping.Mapper.Map<Poc>(PocListVm);
        await _pocs.AddAsync(poc);
        _nav.NavigateTo("/pocs");
    }
}
